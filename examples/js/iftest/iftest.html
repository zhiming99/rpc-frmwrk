<!--
 GENERATED BY RIDLC, MAKE SURE TO BACKUP BEFORE RUNNING RIDLC AGAIN
 Copyright (C) 2024  zhiming <woodhead99@gmail.com>
 This program can be distributed under the terms of the GNU GPLv3.

* command line: /usr/local/bin/ridlc -JO. --odesc_url=http://example.com/rpcf ../../iftest.ridl 
* npm dependency: browserify buffer exports long lz4 process put safe-buffer stream xxhash
-->
<!DOCTYPE html>
<html><head><meta charset="utf-8" /></head></html>
<body>
<p id="log">Sample HTML<br /></p>
<script src="dist/iftest.js">
</script>
<script>
console.log( "hello, iftest!");
var iChecks = 0;
function checkProxyState(){
    if( globalThis.oProxy === undefined ){
        setTimeout( checkProxyState, 2000 );
        console.log( "Waiting RPC connection ready..." );
    }else if( globalThis.oProxy.m_iState === 5 ){
        console.log( "RPC connection is down..." );
        globalThis.oProxy = null;
    }else{
        if( iChecks++ === 0 )
            console.log( "RPC connection ready " + globalThis.oProxy );
        //setTimeout( checkProxyState, 5000 );
        var i0 = new Object();

        i0.extendUserFeature = new Map();
        i0.extendUserFeature.set(2, "extendUserFeature" );
        i0.userFeature = new Map()
        i0.userFeature.set( 1, "userFeature" );
        i0.userOnlineFeature = new Map()
        i0.userOnlineFeature.set( "hello", "userOnlineFeature" );
        i0.userHistoricalStatisticsFeature = new Map()
        i0.userHistoricalStatisticsFeature.set( 3, 5 );
        i0.sceneFeature = new Map()
        i0.sceneFeature.set( 6, "sceneFeature" );
        i0.formL24Exposure = new Map()
        i0.formL24Exposure.set( "formL24Exposure", 7 );
        i0.industryL24Exposure = new Map()
        i0.industryL24Exposure.set( "industryL24Exposure", 8 );
        i0.flightId = "sz2680"
        i0.requestId = "haha9527"
        i0.time = 23456
        i0.flag = 9
        i0.body = [ new Object(), new Object()]
        i0.body[0].adFeature = new Map()
        i0.body[0].adFeature.set( 11, "adFeature" );
        i0.body[0].extendAdFeature = new Map()
        i0.body[0].extendAdFeature.set( 11, "extendAdFeature" );
        i0.body[0].extendAdFeature.set( 14, "extendAdFeature2" );
        i0.body[0].adHistoricalStatisticsFeature = new Map()
        i0.body[0].adHistoricalStatisticsFeature.set( 12, 13 );
        i0.body[0].adHistoricalStatisticsFeature.set( 39, 50 );
        i0.body[0].userRealtimeStatisticsFeature = new Map()
        i0.body[0].userRealtimeStatisticsFeature.set(14, 15 );
        i0.body[0].userRealtimeStatisticsFeature.set(29, 33 );
        i0.body[0].extenduserRealtimeStatisticsFeature = new Map()
        i0.body[0].extenduserRealtimeStatisticsFeature.set(16, 17 );
        i0.body[0].extenduserRealtimeStatisticsFeature.set(22, 22 );
        i0.body[0].adRealtimeStatisticsFeature = new Map() 
        i0.body[0].adRealtimeStatisticsFeature.set(18, 19 );
        i0.body[0].adRealtimeStatisticsFeature.set(38, 39 );
        i0.body[0].adFormId = "bobo";
        i0.body[0].materialId = "steel";
        i0.body[0].creativeId = "cici";
        i0.body[0].sponsorId = "dudu";
        i0.body[1].adFeature = new Map()
        i0.body[1].adFeature.set(11, "adFeature" );
        i0.body[1].extendAdFeature = new Map()
        i0.body[1].extendAdFeature.set(11, "extendAdFeature" );
        i0.body[1].adHistoricalStatisticsFeature = new Map()
        i0.body[1].adHistoricalStatisticsFeature.set(12, 13 );
        i0.body[1].adHistoricalStatisticsFeature.set(22, 23 );
        i0.body[1].userRealtimeStatisticsFeature = new Map()
        i0.body[1].userRealtimeStatisticsFeature.set(14, 15 );
        i0.body[1].userRealtimeStatisticsFeature.set(24, 25 );
        i0.body[1].extenduserRealtimeStatisticsFeature = new Map()
        i0.body[1].extenduserRealtimeStatisticsFeature.set(16, 17 );
        i0.body[1].extenduserRealtimeStatisticsFeature.set(26, 27 );
        i0.body[1].adRealtimeStatisticsFeature = new Map()
        i0.body[1].adRealtimeStatisticsFeature.set(18, 19 );
        i0.body[1].adRealtimeStatisticsFeature.set(28, 29 );
        i0.body[1].adFormId = "foofoo"
        i0.body[1].materialId = "plastic"
        i0.body[1].creativeId = "giogio"
        i0.body[1].sponsorId = "jojo"
        var oContext = new Object();
        var oProxy = globalThis.oProxy;
        return new Promise( (resolve, reject)=>{
            oContext.m_oReject = reject;
            oContext.m_oResolve = resolve;
            oContext.m_oCallback = (oContext, ret, i0r)=>{
              if( ret < 0 )
                console.log( "error returned")
              else
                console.log( i0r );
            }
            return oProxy.Echo( oContext, i0 );
        }).then((e)=>{
        }).catch( (e )=>{
            console.log( e )
        })
    }
}
setTimeout( checkProxyState, 2000 );
//# sourceURL=browsertools://custom/rpc-entry.js
</script>
</body>
