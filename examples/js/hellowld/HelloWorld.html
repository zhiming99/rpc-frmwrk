<!--
 GENERATED BY RIDLC, MAKE SURE TO BACKUP BEFORE RUNNING RIDLC AGAIN
 Copyright (C) 2024  zhiming <woodhead99@gmail.com>
 This program can be distributed under the terms of the GNU GPLv3.

* command line: /usr/local/bin/ridlc -JO. --odesc_url=http://example.com/rpcf ../../hellowld.ridl 
* npm dependency: browserify buffer exports long lz4 process put safe-buffer stream xxhash xxhashjs webpack webpack-cli
-->
<!DOCTYPE html>
<html><head><meta charset="utf-8" /></head></html>
<body>
<p id="log">Sample HTML<br /></p>
<script src="dist/HelloWorld.js">
</script>
<script>
console.log( "hello, HelloWorld!");
var iChecks = 0;
function checkProxyState(){
    if( globalThis.oProxy === undefined ){
        setTimeout( checkProxyState, 2000 );
        console.log( "Waiting RPC connection ready..." );
    }else if( globalThis.oProxy.m_iState === 5 ){
        console.log( "RPC connection is down..." );
        globalThis.oProxy = null;
    }else{
        if( iChecks++ === 0 )
        {
            console.log( "RPC connection ready " + globalThis.oProxy );
            var oContext = new Object();
            var oProxy = globalThis.oProxy;
            return new Promise( (resolve, reject)=>{
                oContext.m_oReject = reject;
                oContext.m_oResolve = resolve;
                oContext.m_oCallback = (oContext, ret, strResp)=>{
                    if( ret & 0x80000000 )
                        console.log( "error returned")
                    else
                        console.log( 'server response is ' + strResp );
                }
                return oProxy.Echo( oContext, "Hello, World!" );
            }).then((e)=>{
                console.log( "Stop the proxy")
                oProxy.Stop();
            }).catch( (e )=>{
                console.log( e )
                oProxy.Stop();
            })
        }
        setTimeout( checkProxyState, 5000 );
    }
}
setTimeout( checkProxyState, 2000 );
//# sourceURL=browsertools://custom/rpc-entry.js
</script>
</body>
